<!DOCTYPE html><html xmlns="http://www.w3.org/1999/html">  <head>    <title>WebSocket Example</title>  </head>  <body>    登录用户ID：<input type="text" id="sendUserId" /></br>    接受用户ID：<input type="text" id="receivedUserId" /></br>    linkId：<input type="text" id="linkId" /></br>    发送消息内容：<input type="text" id="messageInput" /></br>    接受消息内容：<input type="text" id="messageReceive" /></br>    <br>    <button onclick="closeWebSocket()">关闭WebSocket连接</button>    <br>    <button onclick="sendMessage()">发送</button>    <script>      var UserId = sessionStorage.getItem("userId");      var receivedUserId = sessionStorage.getItem("receiverId");      var linkId = sessionStorage.getItem("linkId");      var wsUrl = "ws://192.168.80.1:8085/websocket/" + UserId;      var ws = new WebSocket(wsUrl);      document.getElementById("sendUserId").value = UserId;      document.getElementById("receivedUserId").value = receivedUserId;      document.getElementById("linkId").value = linkId;      ws.onopen = function (event) {        console.log("WebSocket is open now.");        let OnlineInfo = {          linkId: linkId,          msgType: 1, //登录消息          senderId: UserId,          receiverId: receivedUserId,          msgBody: null,          sendTime: Date.now(),          isLatest: 0        };        ws.send(JSON.stringify(OnlineInfo));      };      function closeWebSocket() {        UserId = document.getElementById("sendUserId").value;        receivedUserId = document.getElementById("receivedUserId").value;        let OfflineInfo = {          linkId: linkId,          msgType: 5, //离线消息          senderId: UserId,          receiverId: receivedUserId,          msgBody: null,          sendTime: Date.now(),          isLatest: 0        };        ws.send(JSON.stringify(OfflineInfo));        ws.close();      }      ws.onmessage = function (event) {        var message = event.data;        console.log("Received message: " + message);        messageReceive.value = message;      };      ws.onclose = function (event) {        console.log("WebSocket is closed now.");      };      function sendMessage() {        UserId = document.getElementById("sendUserId").value;        receivedUserId = document.getElementById("receivedUserId").value;        var message = document.getElementById("messageInput").value;        let operateInfo = {          linkId: linkId,          msgType: 2, //文字消息          senderId: UserId,          receiverId: receivedUserId,          msgBody: message,          sendTime: Date.now(),          isLatest: 0        };        ws.send(JSON.stringify(operateInfo));      }      //重复发送心跳包保持链接      setInterval(() => {        UserId = document.getElementById("sendUserId").value;        let HeartBeat = {          linkId: null,          msgType: 0, //心跳消息          senderId: UserId,          receiverId: null,          msgBody: "ping",          sendTime: Date.now(),          isLatest: 0        };        ws.send(JSON.stringify(HeartBeat));        console.log("ping");      }, 30000);    </script>  </body></html>